# ğŸ§ª User Age Calculator API (Go Backend)

A production-style RESTful API built in **Go** to manage users with their **date of birth (DOB)** and calculate **age dynamically** at runtime.

This project is **Docker-first** â€” no need to install MySQL or run `go run` locally.

---

## âœ¨ Features

- Create, update, delete users
- Store **DOB** in database (`DATE`)
- Calculate **age dynamically** using Go `time` package
- List users with pagination
- Input validation with `go-playground/validator`
- Structured logging with **Uber Zap**
- Request ID & request duration middleware
- SQLC for type-safe database access
- Docker + Docker Compose setup

---

## ğŸ›  Tech Stack

- Go
- GoFiber
- MySQL
- SQLC
- Uber Zap
- go-playground/validator
- Docker & Docker Compose

---

## ğŸ“ Project Structure

```

/cmd/server/main.go
/config/
/db/
â”œâ”€â”€ migrations/
â””â”€â”€ sqlc/          # generated by sqlc
/internal/
â”œâ”€â”€ handler/
â”œâ”€â”€ repository/
â”œâ”€â”€ service/
â”œâ”€â”€ routes/
â”œâ”€â”€ middleware/
â”œâ”€â”€ models/
â””â”€â”€ logger/
Dockerfile
docker-compose.yml
.env.example

````

---

## ğŸ—„ Database Schema

```sql
CREATE TABLE users (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  dob DATE NOT NULL
);
````

* `dob` is stored as `DATE`
* `age` is **not stored** â€” calculated dynamically

---

## âš™ï¸ Prerequisites

* Docker
* Docker Compose

âŒ No need to install Go
âŒ No need to install MySQL

---

## ğŸ” Environment Setup

### 1ï¸âƒ£ Create `.env` file

Copy the example file:

```bash
cp .env.example .env
```

Edit `.env` with real values (example):

```env
MYSQL_DATABASE=age_db
MYSQL_USER=app_user
MYSQL_PASSWORD=app_password
MYSQL_ROOT_PASSWORD=root

DATABASE_URL=app_user:app_password@tcp(mysql:3306)/age_db?parseTime=true
```

> âš ï¸ `.env` is ignored by Git and must NOT be committed.

---

## ğŸ³ Run with Docker (Recommended)

### 2ï¸âƒ£ Build and start containers

```bash
docker-compose up --build
```

Docker will:

* Start MySQL inside a container
* Build and run the Go API
* Expose API on port **3000**

â³ First run may take ~1 minute.

---

## ğŸ—„ Create Database Table (One-time)

After containers are running, create the table:

```bash
docker exec -it age-calculator-mysql-1 mysql -u app_user -p
```

```sql
USE age_db;

CREATE TABLE users (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  dob DATE NOT NULL
);
```

---

## ğŸš€ API Endpoints

### â• Create User

**POST** `/users`

```json
{
  "name": "Alice",
  "dob": "1990-05-10"
}
```

**Response**

```json
{
  "id": 1,
  "name": "Alice",
  "dob": "1990-05-10"
}
```

---

### ğŸ“„ Get User by ID

**GET** `/users/:id`

```json
{
  "id": 1,
  "name": "Alice",
  "dob": "1990-05-10",
  "age": 35
}
```

---

### âœï¸ Update User

**PUT** `/users/:id`

```json
{
  "name": "Alice Updated",
  "dob": "1991-03-15"
}
```

**Response**

```json
{
  "id": 1,
  "name": "Alice Updated",
  "dob": "1991-03-15"
}
```

---

### âŒ Delete User

**DELETE** `/users/:id`

**Response**

```
204 No Content
```

---

### ğŸ“ƒ List Users (Paginated)

**GET** `/users?page=1&limit=10`

```json
[
  {
    "id": 1,
    "name": "Alice",
    "dob": "1990-05-10",
    "age": 34
  }
]
```

---

## ğŸ§ª Validation Rules

* `name` â†’ required
* `dob` â†’ required, must be a **past date**
* Future DOBs return `400 Bad Request`

---

## ğŸ“Š Logging & Middleware

* `X-Request-ID` added to every response
* Request duration logged
* Structured JSON logs using Uber Zap

---

## ğŸ§  Important Notes

* Age is calculated at runtime
* No timezone issues (date-only handling)
* Request and response models are separated
* SQLC ensures type-safe DB queries

---

## ğŸ›‘ Stop Containers

```bash
docker-compose down
```

To remove DB data as well:

```bash
docker-compose down -v
```

---

## ğŸ‘¤ Author

**Saurabh Chaurasiya**
---
